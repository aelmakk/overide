#include <stdio.h>
#include <string.h>


// login : AAAAAA | serial : 6229050

int     auth(char *buff, unsigned int serial)
{
    unsigned int    tmp;
    int             ret;

    tmp = strcspn(buff, "\n");
    buff[tmp] = '\0';
    tmp = strnlen(buff, 32);
    if (tmp > 5)
    {
        ptrace(0, 0, 1, 0);
        // if ptrace return -1 display msg tampering detected and return (1)

    }
    else
        ret = 1;
    return (ret);
}

int     main(void)
{   
    int             ret = 0;
    char            buff[32];
    unsigned int    serial;

    //move a canary 
    puts("***********************************");
    puts("*\t\tlevel06\t\t  *");
    puts("***********************************");
    printf("-> Enter Login: ");
    fgets(buff, 32, stdin);
    puts("***********************************");
    puts("***** NEW ACCOUNT DETECTED ********");
    puts("***********************************");
    printf("-> Enter Serial: ");
    scanf("%u", &serial);
    ret = auth(buff, serial);
    if (ret ==  0)
    {
        puts("Authenticated!");
        system("/bin/sh");
        ret = 0;
    }
    else
        ret = 1;
    return (ret);
}